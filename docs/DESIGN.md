# 設計思想と開発規則

このドキュメントは、プロジェクトの設計思想、アーキテクチャ、およびコーディング規則について説明します。新しいメンバーがプロジェクトに参加する際や、既存メンバーが開発方針を確認する際に参照してください。

## 📚 目次

- [設計原則](#設計原則)
- [アーキテクチャ](#アーキテクチャ)
- [コンポーネント設計](#コンポーネント設計)
- [コーディング規約](#コーディング規約)
- [状態管理](#状態管理)
- [スタイリング](#スタイリング)
- [パフォーマンス最適化](#パフォーマンス最適化)
- [アクセシビリティ](#アクセシビリティ)

---

## 設計原則

当プロジェクトは以下の原則に基づいて設計・開発されています：

### 1. 宣言的プログラミング

- **何を**実現するかを記述し、**どのように**実現するかの詳細は抽象化する
- コンポーネントの再利用性を高め、ビジネスロジックを明確に表現する

### 2. 関心の分離 (Separation of Concerns)

- 各コンポーネントやモジュールは単一の責任を持つ
- データ取得、UI 表示、ビジネスロジックを明確に分離する

### 3. 予測可能性と保守性

- 命名規則の一貫性
- ファイル構造の明確な整理
- 型定義による安全性確保

### 4. パフォーマンスとアクセシビリティ

- 初期読み込み速度の最適化
- リンダリング効率の最大化
- WAI-ARIA 規格に準拠した UI 実装

---

## アーキテクチャ

### 技術スタック

- **フレームワーク**：Next.js 15 (App Router)
- **言語**：TypeScript
- **UI ライブラリ**：React 19
- **スタイリング**：TailwindCSS 4
- **コンポーネントライブラリ**：shadcn/ui
- **アニメーション**：Framer Motion
- **リント/フォーマット**：ESLint 9

### ディレクトリ構造

```
src/
├── app/                  # Next.js App Router のページ定義
│   ├── about/            # 自己紹介ページ
│   ├── certifications/   # 資格ページ
│   ├── experience/       # 経験ページ
│   ├── portfolio/        # ポートフォリオページ
│   ├── skills/           # スキルページ
│   ├── globals.css       # グローバルスタイル
│   ├── layout.tsx        # ルートレイアウト
│   └── page.tsx          # ホームページ
│
├── components/           # Atomic Design に基づくコンポーネント
│   ├── atoms/            # 基本的なUI要素
│   ├── molecules/        # 複数のatomsで構成される複合コンポーネント
│   ├── organisms/        # 完全な機能を持つ大きなコンポーネント
│   └── ui/               # shadcn/ui コンポーネント
│
├── lib/                  # 共有ライブラリとユーティリティ関数
│   ├── utils/            # 機能別に分割されたユーティリティ関数
│   ├── data.ts           # データエクスポート
│   ├── portfolio.ts      # ポートフォリオ関連データと関数
│   ├── profile.ts        # プロフィール関連データと関数
│   ├── projects.ts       # プロジェクト関連データと関数
│   └── types.ts          # 共有型定義
```

---

## コンポーネント設計

当プロジェクトでは **Atomic Design** パターンを採用しています。

### Atomic Design とは

Atomic Design は、UI コンポーネントを 5 つの階層に分類する設計手法です：

1. **Atoms**（原子）：ボタン、入力フィールド、アイコンなどの基本要素
2. **Molecules**（分子）：複数のアトムを組み合わせた小さな機能単位
3. **Organisms**（有機体）：複数の分子とアトムからなる独立したコンポーネント
4. **Templates**（テンプレート）：ページのレイアウト構造
5. **Pages**（ページ）：具体的なコンテンツが入ったテンプレート

当プロジェクトでは、主に Atoms、Molecules、Organisms の 3 階層を使用します。

### コンポーネント分類の基準

#### Atoms

- 最小の機能単位で、他のコンポーネントに依存しない
- 例：`Button`, `Badge`, `Icon`, `Input`, `TechnologyBadge`, `BackButton`, `ViewAllButton`

#### Molecules

- 複数の Atoms を組み合わせた機能ユニット
- 特定のユースケースに対応する小さな機能ブロック
- 例：`ProjectLinks`, `FeaturesList`, `SectionTitle`, `FormField`

#### Organisms

- 複数の Molecules と Atoms を組み合わせた完全な機能ブロック
- ページの主要セクションを形成
- 例：`Header`, `Footer`, `PortfolioGrid`, `PortfolioDetail`, `HeroSection`

### コンポーネント命名規則

- コンポーネント名は **PascalCase** で記述
- 具体的で説明的な名前を使用（例：`PortfolioGrid`、`BackButton`）
- 接頭辞や接尾辞で役割を明確化（例：`...Section`, `...Card`, `...List`）

---

## コーディング規約

### TypeScript

- **型の厳格な使用**：暗黙的な any 型を避け、明示的に型を定義する
- **インターフェースとタイプ**:
  - `interface`：オブジェクト構造を定義（例：`UserProfile`）
  - `type`：ユニオン型や型エイリアス（例：`ButtonSize = 'sm' | 'md' | 'lg'`）
- **型注針**：戻り値の型を明示的に指定する
- **JSDoc**：主要な関数やコンポーネントには必ず JSDoc コメントを追加

```typescript
/**
 * ユーザープロファイルを取得する関数
 * @param userId - ユーザーID
 * @returns ユーザープロファイル情報
 */
async function getUserProfile(userId：string)：Promise<UserProfile> {
  // ...
}
```

### React / Next.js

- **関数コンポーネント**：クラスコンポーネントではなく関数コンポーネントを使用
- **Hooks**：カスタムフックでロジックを分離し、再利用性を高める
- **Server Components**：状態を持たないコンポーネントは Server Components として実装
- **Client Components**：インタラクティブな要素を含むコンポーネントのみに`"use client"`を使用
- **Dynamic Import**：必要に応じて`dynamic()`を使用して遅延ロード

### ファイル構成

- **1 ファイル 1 コンポーネント**：基本的に 1 つのファイルには 1 つのコンポーネントのみを定義
- **インデックスエクスポート**：複雑なコンポーネントは個別のフォルダに配置し、index.ts で一括エクスポート
- **命名規則**:
  - コンポーネントファイル：`PascalCase.tsx`
  - ユーティリティファイル：`camelCase.ts`
  - テストファイル：`*.test.tsx` または `*.spec.tsx`

---

## 状態管理

### ローカル状態

- **useState**：コンポーネント内の単純な状態管理
- **useReducer**：複雑な状態ロジックの管理

### グローバル状態

- 現在、グローバル状態管理ライブラリは使用していません
- 将来的にはコンテキスト API を使用して実装予定

### データフェッチ

- **Server Components**：データ取得は Server Components で行うのが基本
- **API Routes**：認証が必要なデータ取得やサードパーティ API の呼び出しには API Routes を使用

---

## スタイリング

### TailwindCSS

- ユーティリティファーストの原則に従い、直接クラスを適用
- カスタムデザインは Tailwind の設定ファイルで一元管理
- 複雑なスタイルには`@apply`ディレクティブを使用
- レスポンシブデザインにはブレークポイント接頭辞を使用（例：`md:`, `lg:`）

### スタイル規則

- **クラス名の順序**：レイアウト → サイズ → スペーシング → 色 → その他
- **条件付きクラス**：`clsx()`や`cn()`ユーティリティを使用して条件付きクラス適用
- **ダークモード**：`dark:`接頭辞を使用してダークモードのスタイルを定義

```tsx
<div className={cn(
  "p-4 rounded-lg", // 基本スタイル
  "bg-white dark:bg-gray-800", // 背景色（ライト/ダーク）
  isActive && "border-blue-500", // 条件付きスタイル
)}>
```

---

## パフォーマンス最適化

### レンダリング最適化

- **メモ化**：適切に`useMemo`と`useCallback`を使用して不要な再計算を防ぐ
- **レンダリング制御**：不要なレンダリングを`React.memo`で防ぐ
- **仮想化**：大量のリストには仮想化ライブラリを検討

### コード分割

- **ページベースの分割**：各ページは自動的に分割される
- **コンポーネント分割**：大きなコンポーネントは`dynamic import`で遅延ロード
- **共通コード抽出**：複数のページで使用される共通コードはバンドラーによって自動抽出

### 画像最適化

- **Next.js Image**：常に`next/image`コンポーネントを使用して画像を最適化
- **WebP 形式**：画像は WebP 形式を優先
- **サイズ指定**：常に`width`と`height`属性を指定
- **Lazy Loading**：`priority`プロパティは必要な場合のみ`true`に設定

---

## アクセシビリティ

すべてのコンポーネントは WCAG 2.1 AA 基準に準拠することを目指します。

### ガイドライン

- **セマンティック HTML**：適切な HTML 要素を使用（`button`、`nav`、`header`など）
- **キーボードナビゲーション**：すべての操作がキーボードで可能なように実装
- **ARIA 属性**：必要に応じて適切な ARIA 属性を追加
- **フォーカス管理**：フォーカスの視覚的な表示とロジック実装
- **カラーコントラスト**：最小コントラスト比 4.5:1 を維持

### アクセシビリティチェック

- **自動テスト**：ESLint の a11y プラグインを使用
- **マニュアルテスト**：スクリーンリーダーでの動作確認
- **コントラストチェック**：デザインツールやブラウザ開発者ツールで確認

---

このドキュメントは、チームの合意のもとで随時更新されます。提案や質問は Issues または Pull Request で行ってください。
